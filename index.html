<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğŸ„ åœ£è¯æ ‘</title>
  <style>
    :root { --bg:#0b1020; --card:#121a33; --text:#e9eeff; }
    body{
      margin:0; min-height:100vh; display:grid; place-items:center;
      background:radial-gradient(1200px 800px at 50% 20%, #16214a, var(--bg));
      color:var(--text); font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    .wrap{ width:min(680px, 92vw); }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.10);
      border-radius:20px; padding:18px 16px;
      box-shadow:0 18px 55px rgba(0,0,0,.35);
    }
    h1{ margin:0 0 10px; font-size:18px; font-weight:700; letter-spacing:.5px; opacity:.95;}
    .hint{ margin:8px 0 0; font-size:12px; opacity:.75; line-height:1.5;}
    pre{
      margin:0; padding:14px 14px 16px;
      background:rgba(0,0,0,.18);
      border-radius:14px;
      overflow:auto;
      font-size:18px;
      line-height:1.25;
      white-space:pre;
    }
    .star{ color:#ff4d4d; text-shadow:0 0 14px rgba(255,77,77,.75); }
    .leaf{ color:#32d06a; }
    .trunk{ color:#d7a34a; }
    .light{
      display:inline-block;
      width:1ch;
      filter:drop-shadow(0 0 10px rgba(255,255,255,.35));
      animation:twinkle 1.2s infinite;
    }
    @keyframes twinkle{
      0%,100%{ opacity:.35; transform:scale(0.9); }
      50%{ opacity:1; transform:scale(1.08); }
    }
    .footer{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      margin-top:10px; opacity:.8; font-size:12px;
    }
    button{
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:8px 10px;
      border-radius:12px;
      cursor:pointer;
    }
    button:active{ transform:translateY(1px); }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>ğŸ„ Merry Christmas åˆ˜æ…§é¢–</h1>
      <pre id="tree" aria-label="ascii christmas tree"></pre>

      <div class="footer">
        <div>ç¯å…‰ä¼šéšæœºé—ªçƒï¼ˆå¾®ä¿¡å†…ç½®æµè§ˆå™¨å¯ç”¨ï¼‰</div>
        <button id="btn">æ¢ä¸€ç»„ç¯å…‰</button>
      </div>
      <div class="hint"></div>
    </div>
  </div>

  <script>
    const height = 12;        // æ ‘é«˜åº¦
    const trunkH = 2;         // æ ‘å¹²é«˜åº¦
    const lightProb = 0.22;   // ç¯å‡ºç°æ¦‚ç‡

    const lightColors = ["#ffd166","#06d6a0","#4cc9f0","#f72585","#bdb2ff","#ff9f1c"];
    const pre = document.getElementById("tree");
    const btn = document.getElementById("btn");

    function randInt(n){ return Math.floor(Math.random()*n); }
    function pick(arr){ return arr[randInt(arr.length)]; }

    function span(cls, text, style=""){
      const s = document.createElement("span");
      if (cls) s.className = cls;
      if (style) s.style = style;
      s.textContent = text;
      return s;
    }

    function buildTree(){
      pre.innerHTML = "";
      const lines = [];

      // é¡¶éƒ¨æ˜Ÿæ˜Ÿï¼ˆå¯¹é½æ ‘é¡¶ï¼‰
      lines.push({ parts: [ {cls:"", text:" ".repeat(height-1)}, {cls:"star", text:"â˜…"} ] });

      // æ ‘å† 
      for (let i=0;i<height;i++){
        const pad = " ".repeat(height - i - 1);
        const width = 2*i + 1;
        const parts = [{cls:"", text:pad}];

        for (let j=0;j<width;j++){
          // éšæœºç¯ï¼šæŠŠéƒ¨åˆ† * æ¢æˆå½©è‰² â—
          if (Math.random() < lightProb && i>1 && j>0 && j<width-1){
            const color = pick(lightColors);
            parts.push({cls:"light", text:"â—", style:`color:${color}; animation-delay:${Math.random()*1.2}s;`});
          } else {
            parts.push({cls:"leaf", text:"*"});
          }
        }
        lines.push({parts});
      }

      // æ ‘å¹²
      for (let t=0;t<trunkH;t++){
        lines.push({
          parts: [
            {cls:"", text:" ".repeat(height-1)},
            {cls:"trunk", text:"|"}
          ]
        });
      }

      // æ¸²æŸ“
      for (const line of lines){
        const frag = document.createDocumentFragment();
        for (const p of line.parts){
          frag.appendChild(span(p.cls, p.text, p.style || ""));
        }
        pre.appendChild(frag);
        pre.appendChild(document.createTextNode("\n"));
      }
    }

    // åˆæ¬¡æ¸²æŸ“
    buildTree();

    // æ¯éš”ä¸€æ®µæ—¶é—´åˆ·æ–°é—ªçƒï¼ˆè½»é‡ï¼Œå¾®ä¿¡ä¹Ÿä¸å¡ï¼‰
    setInterval(buildTree, 1600);

    btn.addEventListener("click", buildTree);
  </script>
</body>
</html>
